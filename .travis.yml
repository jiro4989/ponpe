language: go

env:
  global:
    - GO111MODULE=on

install:
  - make bootstrap

script:
  - go version
  - make build
  - make install
  - make test
  - ./bin/ponpe -h
  - ./bin/ponpe -v

before_deploy:
  - make archive

deploy:
  provider: releases
  api_key:
    secure: LGviSz7oNkBE3aTMas3ic97RK32dUT7vHpiM+Ln6qXkMpgn7FPiF+WZqLElRHXZIIlFEWNXwq8ukpBivqc2P3ZrLMFOy1dXEhVVwFY6E+vsg2zTM6SHZuwC40x3BY+kwUzkEgoBSXoW9lM90dTMGO32pD7pIqGABxG3leRi/ItmMphBLXJ71JCckBDuDy+Pw9rkJ/cqyxQkwNHvQR0rdppM708hP7E4BpUcziAHmycSU5jVcBGK3+1agkVsWlbX8ADdJbOuMT9dHhV9UbMzKBB4v3Bvs4Ri1E0MBNGk5akJRK3vj2NHJ6EeA0h2RYVXZVP0rLGDBmAIGZfWfJFbxW7UnUiJ+w+ySnDiAdS801cj8UK6QiJ0zgFtQ+gYnjvI4XBpv8asAjqWbewQx6uArdOxfYCgQcwXTjQly3TvpuMKjsePWyb6awgq0BAOLI/3RM36DgFoD6JyCK3t6gzSZX7ABQJCgOrk0Y/H2H7owGOmR059UIriKahhPFKFpvaCb4koegZstDzL0Tvtsy5HgYzD1fe+2W1YQBaxY76nlsF+9sXIvwNh1MjP+uEAQ0gUPUCYA3RE1nitlszXMFv29Qqzg9W5vcXH00G+d1giHgwmNh/hKHtCb1AB2cONCxUrKGPmm/LhmOfnA7+8sh9xoF9kfgK7ZfSf859OPZUxU7MM=
  keep-history: false
  skip_cleanup: true
  file:
    - 'dist/*.tar.gz'
    - 'dist/*.zip'
  file_glob: true
  on:
    tags: true
    condition: $TRAVIS_OS_NAME = linux
